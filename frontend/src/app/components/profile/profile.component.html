<!-- <div class="profile-container">
 
    <div class="profile-header">
      <div class="header-content">
        <div class="user-avatar">
          <div class="avatar-circle">
            {{ user?.username?.charAt(0)?.toUpperCase() || 'U' }}
          </div>
        </div>
        <div class="user-info">
          <h1>{{ user?.username || 'User' }}</h1>
          <p class="user-role">{{ user?.role ? (user.role | titlecase) : 'Policyholder' }}</p>
          <p class="user-email">{{ user?.email || 'No email provided' }}</p>
        </div>
        <button class="logout-btn" (click)="logout()">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </div>
  
   
    <div class="profile-tabs">
      <button 
        class="tab-btn" 
        [class.active]="activeTab === 'policies'"
        (click)="switchTab('policies')">
        <i class="fas fa-file-contract"></i> My Policies
      </button>
      <button 
        class="tab-btn" 
        [class.active]="activeTab === 'profile'"
        (click)="switchTab('profile')">
        <i class="fas fa-user"></i> Profile Details
      </button>
      <button 
        class="tab-btn" 
        [class.active]="activeTab === 'claims'"
        (click)="switchTab('claims')">
        <i class="fas fa-file-claim"></i> My Claims
      </button>
    </div>
  
   
    <div class="profile-content">
    
      <div *ngIf="activeTab === 'policies'" class="tab-content">
        <div class="section-header">
          <h2>My Insurance Policies</h2>
          <p>Manage and view your current insurance policies</p>
        </div>
  
        <div *ngIf="isLoading" class="loading-state">
          <i class="fas fa-spinner fa-spin"></i>
          <p>Loading your policies...</p>
        </div>
  
        <div *ngIf="!isLoading && userPolicies.length === 0" class="empty-state">
          <i class="fas fa-folder-open"></i>
          <h3>No policies found</h3>
          <p>You haven't purchased any policies yet.</p>
          <button class="btn-primary" routerLink="/policies">
            Browse Policies
          </button>
        </div>
  
        <div *ngIf="!isLoading && userPolicies.length > 0" class="policies-grid">
          <div *ngFor="let policy of userPolicies" class="policy-card">
            <div class="policy-header">
              <div class="policy-icon">
                <i class="fas {{ getPolicyIcon(policy.type) }}"></i>
              </div>
              <div class="policy-title">
                <h3>{{ policy.name }}</h3>
                <span class="policy-type">{{ policy.type }} Insurance</span>
              </div>
            </div>
  
            <div class="policy-details">
              <div class="detail-item">
                <span class="label">Policy Number:</span>
                <span class="value">{{ policy.policyNumber }}</span>
              </div>
              <div class="detail-item">
                <span class="label">Coverage Amount:</span>
                <span class="value">${{ policy.coverageAmount | number }}</span>
              </div>
              <div class="detail-item">
                <span class="label">Premium:</span>
                <span class="value">${{ policy.premium }}/month</span>
              </div>
              <div class="detail-item">
                <span class="label">Start Date:</span>
                <span class="value">{{ policy.startDate | date }}</span>
              </div>
              <div class="detail-item">
                <span class="label">End Date:</span>
                <span class="value">{{ policy.endDate | date }}</span>
              </div>
              <div class="detail-item">
                <span class="label">Status:</span>
                <span class="value status-badge {{ getStatusClass(policy.status) }}">
                  {{ policy.status }}
                </span>
              </div>
            </div>
  
            <div class="policy-actions">
              <button class="btn-outline" (click)="viewPolicyDetails(policy.id)">
                <i class="fas fa-eye"></i> View Details
              </button>
              <button class="btn-primary" (click)="makeClaim(policy.id)">
                <i class="fas fa-file-claim"></i> Make Claim
              </button>
            </div>
          </div>
        </div>
      </div>
  

      <div *ngIf="activeTab === 'profile'" class="tab-content">
        <div class="section-header">
          <h2>Profile Information</h2>
          <p>Manage your personal information and account settings</p>
        </div>
        
        <div class="profile-details-card">
          <div class="detail-section">
            <h3>Personal Information</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <label>Full Name</label>
                <p>{{ user?.username || 'Not provided' }}</p>
              </div>
              <div class="detail-item">
                <label>Email Address</label>
                <p>{{ user?.email || 'Not provided' }}</p>
              </div>
              <div class="detail-item">
                <label>Phone Number</label>
                <p>{{ user?.phone || 'Not provided' }}</p>
              </div>
              <div class="detail-item">
                <label>Member Since</label>
                <p>{{ user?.joinDate || '2023' }}</p>
              </div>
            </div>
          </div>
  
          <div class="detail-section">
            <h3>Account Type</h3>
            <div class="account-type">
              <i class="fas fa-user-shield"></i>
              <span>{{ user?.role ? (user.role | titlecase) : 'Standard' }} Account</span>
            </div>
          </div>
  
          <div class="action-buttons">
            <button class="btn-primary">
              <i class="fas fa-edit"></i> Edit Profile
            </button>
            <button class="btn-outline">
              <i class="fas fa-lock"></i> Change Password
            </button>
          </div>
        </div>
      </div>
  
    
      <div *ngIf="activeTab === 'claims'" class="tab-content">
        <div class="section-header">
          <h2>My Claims</h2>
          <p>View and manage your insurance claims</p>
        </div>
        
        <div class="empty-state">
          <i class="fas fa-file-claim"></i>
          <h3>No claims submitted</h3>
          <p>You haven't filed any claims yet.</p>
          <button class="btn-primary" routerLink="/policies">
            File a Claim
          </button>
        </div>
      </div>
    </div>
  </div> -->




  <!-- <div class="profile-container">
    
    <div class="profile-header">
      <div class="header-content">
        <div class="user-avatar">
          <div class="avatar-circle">
            {{ user?.username?.charAt(0)?.toUpperCase() || 'U' }}
          </div>
        </div>
        <div class="user-info">
          <h1>{{ user?.username || 'User' }}</h1>
          <p class="user-role">{{ user?.role ? (user.role | titlecase) : 'Policyholder' }}</p>
          <p class="user-email">{{ user?.email || 'No email provided' }}</p>
          
   
          <div class="premium-summary" *ngIf="totalPremiumDue > 0">
            <i class="fas fa-exclamation-triangle"></i>
            <span>Total Premium Due: ${{ totalPremiumDue }}</span>
          </div>
        </div>
        <button class="logout-btn" (click)="logout()">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </div>
  
 
    <div class="stats-overview">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-file-contract"></i>
        </div>
        <div class="stat-content">
          <h3>{{ userPolicies.length }}</h3>
          <p>Total Policies</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-check-circle"></i>
        </div>
        <div class="stat-content">
          <h3>{{ activePoliciesCount }}</h3>
          <p>Active Policies</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-clock"></i>
        </div>
        <div class="stat-content">
          <h3>{{ userPolicies.filter(p => p.status === 'pending').length }}</h3>
          <p>Pending Approval</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-money-bill-wave"></i>
        </div>
        <div class="stat-content">
          <h3>${{ totalPremiumDue }}</h3>
          <p>Total Due</p>
        </div>
      </div>
    </div>
  
  
    <div class="profile-tabs">
      <button class="tab-btn" [class.active]="activeTab === 'policies'" (click)="switchTab('policies')">
        <i class="fas fa-file-contract"></i> My Policies
      </button>
      <button class="tab-btn" [class.active]="activeTab === 'profile'" (click)="switchTab('profile')">
        <i class="fas fa-user"></i> Profile Details
      </button>
      <button class="tab-btn" [class.active]="activeTab === 'claims'" (click)="switchTab('claims')">
        <i class="fas fa-file-claim"></i> My Claims
      </button>
    </div>
  
   
    <div class="profile-content">
   
      <div *ngIf="activeTab === 'policies'" class="tab-content">
        <div class="section-header">
          <h2>My Insurance Policies</h2>
          <p>Manage and view your current insurance policies</p>
        </div>
  
        <div *ngIf="isLoading" class="loading-state">
          <i class="fas fa-spinner fa-spin"></i>
          <p>Loading your policies...</p>
        </div>
  
        <div *ngIf="!isLoading && userPolicies.length === 0" class="empty-state">
          <i class="fas fa-folder-open"></i>
          <h3>No policies found</h3>
          <p>You haven't purchased any policies yet.</p>
          <button class="btn-primary" routerLink="/policies">
            Browse Policies
          </button>
        </div>
  
        <div *ngIf="!isLoading && userPolicies.length > 0" class="policies-grid">
          <div *ngFor="let policy of userPolicies" class="policy-card">
            <div class="policy-header">
              <div class="policy-icon">
                <i class="fas {{ getPolicyIcon(policy.type) }}"></i>
              </div>
              <div class="policy-title">
                <h3>{{ policy.name }}</h3>
                <span class="policy-type">{{ policy.type }} Insurance</span>
                <span class="policy-number">#{{ policy.policyNumber }}</span>
              </div>
              <div class="policy-status">
                <span class="status-badge {{ getStatusClass(policy.status) }}">
                  {{ policy.status | titlecase }}
                </span>
              </div>
            </div>
  
            <div class="policy-details">
              <div class="detail-item">
                <span class="label">Coverage Amount:</span>
                <span class="value">${{ policy.coverageAmount | number }}</span>
              </div>
              <div class="detail-item">
                <span class="label">Monthly Premium:</span>
                <span class="value">${{ policy.premium }}</span>
              </div>
              <div class="detail-item">
                <span class="label">Payment Status:</span>
                <span class="value payment-badge {{ getPaymentStatusClass(policy.paymentStatus) }}">
                  {{ policy.paymentStatus | titlecase }}
                </span>
              </div>
              <div class="detail-item" *ngIf="policy.paymentStatus !== 'paid'">
                <span class="label">Amount Due:</span>
                <span class="value">${{ policy.premiumDue }}</span>
              </div>
              <div class="detail-item">
                <span class="label">Next Payment:</span>
                <span class="value">{{ policy.nextPremiumDate | date }}</span>
                <span class="days-left" *ngIf="getDaysUntilDue(policy.nextPremiumDate) > 0">
                  (in {{ getDaysUntilDue(policy.nextPremiumDate) }} days)
                </span>
              </div>
              <div class="detail-item" *ngIf="policy.status === 'pending'">
                <span class="label">Approval Status:</span>
                <span class="value">{{ getApprovalStatus(policy) }}</span>
              </div>
            </div>
  
            <div class="policy-actions">
              <button class="btn-outline" (click)="viewPolicyDetails(policy.id)">
                <i class="fas fa-eye"></i> Details
              </button>
              
              <button 
                class="btn-primary" 
                (click)="payPremium(policy)"
                [disabled]="policy.paymentStatus === 'paid' || policy.status !== 'active'"
                [class.btn-disabled]="policy.paymentStatus === 'paid' || policy.status !== 'active'">
                <i class="fas fa-credit-card"></i> 
                {{ policy.paymentStatus === 'paid' ? 'Paid' : 'Pay Premium' }}
              </button>
              
              <button 
                class="btn-secondary" 
                (click)="makeClaim(policy.id)"
                [disabled]="policy.status !== 'active'"
                [class.btn-disabled]="policy.status !== 'active'">
                <i class="fas fa-file-claim"></i> Claim
              </button>
            </div>
          </div>
        </div>
      </div>
  
    </div>
  </div> -->





  <div class="profile-container">
    <!-- Header Section -->
    <div class="profile-header">
      <div class="header-content">
        <div class="user-avatar">
          <div class="avatar-circle">
            {{ user?.username?.charAt(0)?.toUpperCase() || 'U' }}
          </div>
        </div>
        <div class="user-info">
          <h1>{{ user?.username || 'User' }}</h1>
          <p class="user-role">{{ user?.role ? (user.role | titlecase) : 'Policyholder' }}</p>
          <p class="user-email">{{ user?.email || 'No email provided' }}</p>
          <p class="user-id">User ID: {{ user?.id }}</p>
          
          <div class="premium-summary" *ngIf="totalPremiumDue > 0">
            <i class="fas fa-exclamation-triangle"></i>
            <span>Total Premium Due: ${{ totalPremiumDue }}</span>
          </div>
        </div>
        <button class="logout-btn" (click)="logout()">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </div>
  
    <!-- Stats Overview -->
    <div class="stats-overview">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-file-contract"></i>
        </div>
        <div class="stat-content">
          <h3>{{ userPolicies.length }}</h3>
          <p>Total Policies</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-check-circle"></i>
        </div>
        <div class="stat-content">
          <h3>{{ activePoliciesCount }}</h3>
          <p>Active Policies</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-clock"></i>
        </div>
        <div class="stat-content">
          <h3>{{ pendingPoliciesCount }}</h3>
          <p>Pending Approval</p>
        </div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon">
          <i class="fas fa-money-bill-wave"></i>
        </div>
        <div class="stat-content">
          <h3>${{ totalPremiumDue }}</h3>
          <p>Total Due</p>
        </div>
      </div>
    </div>
  
    <!-- Navigation Tabs -->
    <div class="profile-tabs">
      <button class="tab-btn" [class.active]="activeTab === 'policies'" (click)="switchTab('policies')">
        <i class="fas fa-file-contract"></i> My Policies
      </button>
      <button class="tab-btn" [class.active]="activeTab === 'profile'" (click)="switchTab('profile')">
        <i class="fas fa-user"></i> Profile Details
      </button>
      <button class="tab-btn" [class.active]="activeTab === 'claims'" (click)="switchTab('claims')">
        <i class="fas fa-file-claim"></i> My Claims
      </button>
    </div>
  
    <!-- Content Section -->
    <div class="profile-content">
      <!-- Policies Tab -->
      <div *ngIf="activeTab === 'policies'" class="tab-content">
        <div class="section-header">
          <h2>My Insurance Policies</h2>
          <p>Manage and view your current insurance policies</p>
        </div>
  
        <div *ngIf="isLoading" class="loading-state">
          <i class="fas fa-spinner fa-spin"></i>
          <p>Loading your policies...</p>
        </div>
  
        <div *ngIf="!isLoading && userPolicies.length === 0" class="empty-state">
          <i class="fas fa-folder-open"></i>
          <h3>No policies found</h3>
          <p>You haven't purchased any policies yet.</p>
          <button class="btn-primary" routerLink="/policies">
            Browse Policies
          </button>
        </div>
  
        <div *ngIf="!isLoading && userPolicies.length > 0" class="policies-grid">
          <div *ngFor="let policy of userPolicies" class="policy-card">
            <div class="policy-header">
              <div class="policy-icon">
                <i class="fas" [ngClass]="getPolicyIcon(policy.policy_type)"></i>
              </div>
              <div class="policy-title">
                <h3>{{ getPolicyTypeName(policy.policy_type) }}</h3>
                <span class="policy-type">{{ policy.policy_type | titlecase }} Insurance</span>
                <span class="policy-number">#{{ policy.id }}</span>
              </div>
              <div class="policy-status">
                <span class="status-badge" [ngClass]="getStatusClass(policy.status)">
                  {{ policy.status | titlecase }}
                </span>
              </div>
            </div>
  
            <div class="policy-details">
              <div class="detail-item">
                <span class="label">Coverage Amount:</span>
                <span class="value">{{ policy.coverageAmount | number }}</span>
              </div>
              <div class="detail-item">
                <span class="label">Monthly Premium:</span>
                <span class="value">{{ policy.premium }}</span>
              </div>
              <div class="detail-item">
                <span class="label">Payment Status:</span>
                <span class="value payment-badge" [ngClass]="getPaymentStatusClass(policy.paymentStatus)">
                  {{ policy.paymentStatus | titlecase }}
                </span>
              </div>
              
              <div class="detail-item" *ngIf="policy.paymentStatus !== 'paid'">
                <span class="label">Amount Due:</span>
                <span class="value">{{ policy.premiumDue }}</span>
              </div>
              
              <div class="detail-item" *ngIf="policy.status === 'active'">
                <span class="label">Next Payment:</span>
                <span class="value">{{ policy.nextPremiumDate | date }}</span>
                <span class="days-left" *ngIf="getDaysUntilDue(policy.nextPremiumDate) > 0">
                  (in {{ getDaysUntilDue(policy.nextPremiumDate) }} days)
                </span>
              </div>
              
              <div class="detail-item" *ngIf="policy.status === 'pending' || policy.status === 'rejected'">
                <span class="label">Approval Status:</span>
                <span class="value">{{ getApprovalStatus(policy) }}</span>
              </div>
              
              <div class="detail-item" *ngIf="policy.agent_approved_at">
                <span class="label">Agent Approved:</span>
                <span class="value">{{ formatDate(policy.agent_approved_at) }}</span>
              </div>
              
              <div class="detail-item" *ngIf="policy.admin_approved_at">
                <span class="label">Admin Approved:</span>
                <span class="value">{{ formatDate(policy.admin_approved_at) }}</span>
              </div>
              
              <div class="detail-item">
                <span class="label">Created:</span>
                <span class="value">{{ formatDate(policy.created_at) }}</span>
              </div>
              
              <div class="detail-item" *ngIf="policy.notes">
                <span class="label">Notes:</span>
                <span class="value notes">{{ policy.notes }}</span>
              </div>
            </div>
  
            <div class="policy-actions">
              <button class="btn-outline" (click)="viewPolicyDetails(policy.id)">
                <i class="fas fa-eye"></i> Details
              </button>
              
              <button class="btn-primary" (click)="payPremium(policy)" [disabled]="!canPayPremium(policy)" [class.btn-disabled]="!canPayPremium(policy)">
                <i class="fas fa-credit-card"></i> 
                {{ policy.paymentStatus === 'paid' ? 'Paid' : 'Pay Premium' }}
              </button>
              
              <button class="btn-secondary" (click)="makeClaim(policy.id)" [disabled]="!canMakeClaim(policy)" [class.btn-disabled]="!canMakeClaim(policy)">
                <i class="fas fa-file-claim"></i> Claim
              </button>
            </div>
          </div>
        </div>
      </div>
  
      <!-- Profile Details Tab -->
      <div *ngIf="activeTab === 'profile'" class="tab-content">
        <div class="section-header">
          <h2>Profile Information</h2>
          <p>Manage your personal information and account settings</p>
        </div>
        
        <div class="profile-details-card">
          <div class="detail-section">
            <h3>Personal Information</h3>
            <div class="detail-grid">
              <div class="detail-item">
                <label>User ID</label>
                <p>{{ user?.id || 'Not available' }}</p>
              </div>
              <div class="detail-item">
                <label>Username</label>
                <p>{{ user?.username || 'Not provided' }}</p>
              </div>
              <div class="detail-item">
                <label>Email Address</label>
                <p>{{ user?.email || 'Not provided' }}</p>
              </div>
              <div class="detail-item">
                <label>Account Type</label>
                <p>{{ user?.role ? (user.role | titlecase) : 'Standard' }}</p>
              </div>
              <div class="detail-item">
                <label>Total Policies</label>
                <p>{{ userPolicies.length }}</p>
              </div>
              <div class="detail-item">
                <label>Active Policies</label>
                <p>{{ activePoliciesCount }}</p>
              </div>
            </div>
          </div>
  
          <div class="action-buttons">
            <button class="btn-primary">
              <i class="fas fa-edit"></i> Edit Profile
            </button>
            <button class="btn-outline">
              <i class="fas fa-lock"></i> Change Password
            </button>
          </div>
        </div>
      </div>
  
      <!-- Claims Tab -->
      <div *ngIf="activeTab === 'claims'" class="tab-content">
        <div class="section-header">
          <h2>My Claims</h2>
          <p>View and manage your insurance claims</p>
        </div>
        
        <div class="empty-state">
          <i class="fas fa-file-claim"></i>
          <h3>No claims submitted</h3>
          <p>You haven't filed any claims yet.</p>
          <button class="btn-primary" routerLink="/make-claim" [disabled]="activePoliciesCount === 0" [class.btn-disabled]="activePoliciesCount === 0">
            File a Claim
          </button>
        </div>
      </div>
    </div>
  </div>