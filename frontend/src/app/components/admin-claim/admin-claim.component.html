<div class="admin-container">
  <div class="page-header">
    <h2><i class="fas fa-file-alt"></i> Agent Approved Applications</h2>
    <div class="header-actions">
      <div class="search-box">
        <i class="fas fa-search"></i>
        <input type="text" placeholder="Search claims..." (input)="filterClaims($event)">
      </div>
      <button class="filter-btn">
        <i class="fas fa-filter"></i> Filters
      </button>
    </div>
  </div>

  <div class="stats-cards">
    <div class="stat-card">
      <div class="stat-icon pending">
        <i class="fas fa-clock"></i>
      </div>
      <div class="stat-info">
        <h3>{{ claims.length }}</h3>
        <p>Pending Claims</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon approved">
        <i class="fas fa-check-circle"></i>
      </div>
      <div class="stat-info">
        <h3>{{ getApprovedTodayCount() }}</h3>
        <p>Approved Today</p>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon amount">
        <i class="fas fa-dollar-sign"></i>
      </div>
      <div class="stat-info">
        <h3>${{ getTotalAmount() | number:'1.2-2' }}</h3>
        <p>Total Approved Amount</p>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <i class="fas fa-spinner fa-spin"></i>
    <p>Loading claims...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="errorMessage && !isLoading" class="error-state">
    <i class="fas fa-exclamation-circle"></i>
    <p>{{ errorMessage }}</p>
    <button class="retry-btn" (click)="loadAgentApprovedClaims()">Retry</button>
  </div>

  <!-- Main Content Area -->
  <div *ngIf="!isLoading && !errorMessage" class="content-area">
    <!-- Claims Cards Column -->
    <div class="cards-column" [class.details-active]="selectedClaim">
      <h3>Claims ({{ filteredClaims.length }})</h3>
      
      <!-- Empty State -->
      <div *ngIf="filteredClaims.length === 0" class="empty-state">
        <i class="fas fa-folder-open"></i>
        <p>No agent-approved claims found</p>
        <p *ngIf="searchQuery" class="search-empty">No results for "{{ searchQuery }}"</p>
      </div>

      <!-- Claims Cards -->
      <div *ngIf="filteredClaims.length > 0" class="claims-cards">
        <div *ngFor="let claim of filteredClaims" 
             class="claim-card" 
             [class.active]="selectedClaim?.id === claim.id"
             (click)="selectClaim(claim)">
          
          <div class="card-header">
            <div class="user-info">
              <div class="avatar">{{ getUserInitial(claim.user_name) }}</div>
              <div class="user-details">
                <h4>{{ claim.user_name || 'Unknown User' }}</h4>
                <p>Claim #{{ claim.id }}</p>
              </div>
            </div>
            <span class="amount">${{ claim.amount || '0.00' }}</span>
          </div>

          <div class="card-content">
            <p class="description">{{ claim.description || 'No description provided' }}</p>
            <div class="status-row">
              <span class="status-badge {{ getStatusClass(claim.status) }}">
                {{ claim.status || 'Unknown' }}
              </span>
              <span class="policy-badge">{{ claim.policy_type || 'N/A' }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Details Column -->
    <div class="details-column" *ngIf="selectedClaim">
      <div class="details-header">
        <h3>Claim Details</h3>
        <button class="btn-close" (click)="selectedClaim = null">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="details-content">
        <div class="details-section">
          <h4>Claim Information</h4>
          <div class="detail-grid">
            <div class="detail-item">
              <label>Claim ID</label>
              <p>{{ selectedClaim.id }}</p>
            </div>
            <div class="detail-item">
              <label>Policy ID</label>
              <p>{{ selectedClaim.policy_id || 'N/A' }}</p>
            </div>
            <div class="detail-item">
              <label>Policy Type</label>
              <p>{{ selectedClaim.policy_type || 'N/A' }}</p>
            </div>
            <div class="detail-item">
              <label>Submitted Date</label>
              <p>{{ today | date:'mediumDate' }}</p>
            </div>
            <div class="detail-item">
              <label>Amount</label>
              <p class="amount">${{ selectedClaim.amount || '0.00' }}</p>
            </div>
            <div class="detail-item">
              <label>Status</label>
              <p>
                <span class="status-badge {{ getStatusClass(selectedClaim.status) }}">
                  {{ selectedClaim.status || 'Unknown' }}
                </span>
              </p>
            </div>
          </div>
        </div>

        <div class="details-section">
          <h4>User Information</h4>
          <div class="user-detail">
            <div class="avatar large">{{ getUserInitial(selectedClaim.user_name) }}</div>
            <div class="user-info">
              <h3>{{ selectedClaim.user_name || 'Unknown User' }}</h3>
              <p>User details would appear here</p>
            </div>
          </div>
        </div>

        <div class="details-section">
          <h4>Description</h4>
          <p class="description-full">{{ selectedClaim.description || 'No description provided' }}</p>
        </div>

        <div class="details-section">
          <h4>Documents</h4>
          <div class="documents-list">
            <div class="document-item">
              <i class="fas fa-file-pdf"></i>
              <span>Claim_form.pdf</span>
            </div>
            <div class="document-item">
              <i class="fas fa-file-image"></i>
              <span>Damage_photos.zip</span>
            </div>
            <div class="document-item">
              <i class="fas fa-file-invoice"></i>
              <span>Invoice_receipt.pdf</span>
            </div>
          </div>
        </div>

        <div class="action-buttons">
          <button class="btn-reject" (click)="rejectClaim(selectedClaim.id!)">
            <i class="fas fa-times"></i> Reject Claim
          </button>
          <button class="btn-approve" (click)="approveClaim(selectedClaim.id!)">
            <i class="fas fa-check"></i> Approve Claim
          </button>
        </div>
      </div>
    </div>

    <!-- Empty Details State -->
    <div class="empty-details" *ngIf="!selectedClaim">
      <div class="empty-details-content">
        <i class="fas fa-search"></i>
        <h3>Select a claim to view details</h3>
        <p>Click on any claim from the list to see detailed information and take action.</p>
      </div>
    </div>
  </div>
</div>